CREATE VIEW population_per_province AS select count(`m`.`id`) AS `population`,`f`.`province_id` AS `province_id`,`v`.`name` AS `name` from (((`bagustec_iwsku`.`member` `m` join `bagustec_iwsku`.`family_member` `fm` on(`fm`.`member_id` = `m`.`id`)) join `bagustec_iwsku`.`family` `f` on(`fm`.`family_id` = `f`.`id`)) join `bagustec_iwsku`.`m_province` `v` on(`f`.`province_id` = `v`.`id`)) where `m`.`is_life` = '1' group by `f`.`province_id`;

CREATE VIEW population_per_city AS select count(`m`.`id`) AS `population`,`f`.`city_id` AS `city_id`,`v`.`name` AS `name` from (((`bagustec_iwsku`.`member` `m` join `bagustec_iwsku`.`family_member` `fm` on(`fm`.`member_id` = `m`.`id`)) join `bagustec_iwsku`.`family` `f` on(`fm`.`family_id` = `f`.`id`)) join `bagustec_iwsku`.`m_city` `v` on(`f`.`city_id` = `v`.`id`)) where `m`.`is_life` = '1' group by `f`.`city_id`;

CREATE VIEW population_per_district AS select count(`m`.`id`) AS `population`,`f`.`district_id` AS `district_id`,`v`.`name` AS `name` from (((`bagustec_iwsku`.`member` `m` join `bagustec_iwsku`.`family_member` `fm` on(`fm`.`member_id` = `m`.`id`)) join `bagustec_iwsku`.`family` `f` on(`fm`.`family_id` = `f`.`id`)) join `bagustec_iwsku`.`m_district` `v` on(`f`.`district_id` = `v`.`id`)) where `m`.`is_life` = '1' group by `f`.`district_id`;

CREATE VIEW population_per_village AS select count(`m`.`id`) AS `population`,`f`.`village_id` AS `village_id`,`v`.`name` AS `name` from (((`bagustec_iwsku`.`member` `m` join `bagustec_iwsku`.`family_member` `fm` on(`fm`.`member_id` = `m`.`id`)) join `bagustec_iwsku`.`family` `f` on(`fm`.`family_id` = `f`.`id`)) join `bagustec_iwsku`.`m_village` `v` on(`f`.`village_id` = `v`.`id`)) where `m`.`is_life` = '1' group by `f`.`village_id`;